#!/bin/sh

# Pre-push hook that runs build before pushing
# This ensures code compiles and passes TypeScript checks before pushing

echo "🔨 Running build before push..."

# Run the build command
npm run build

# Capture the exit code
BUILD_STATUS=$?

# Check if build failed
if [ $BUILD_STATUS -ne 0 ]; then
    echo "❌ Build failed! Please fix errors before pushing."
    echo "💡 Run 'npm run build' to see the errors."
    exit 1
fi

echo "✅ Build successful! Proceeding with push..."

# Optionally, you can also run tests
# Uncomment the following lines if you want to run tests as well:
# echo "🧪 Running tests..."
# npm test
# TEST_STATUS=$?
# if [ $TEST_STATUS -ne 0 ]; then
#     echo "❌ Tests failed! Please fix failing tests before pushing."
#     echo "💡 Run 'npm test' to see the failures."
#     exit 1
# fi
# echo "✅ Tests passed!"

exit 0