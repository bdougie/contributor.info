#!/bin/sh

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Check if any staged files are TypeScript files
if echo "$STAGED_FILES" | grep -qE '\.(ts|tsx)$'; then
  echo "üîç Running TypeScript type check on staged files..."

  # Run full type check (needed because TypeScript needs to check dependencies)
  # But only if TypeScript files were changed
  npx tsc -b --noEmit
  if [ $? -ne 0 ]; then
    echo "‚ùå TypeScript type check failed. Please fix type errors before committing."
    exit 1
  fi
  echo "‚úÖ TypeScript check passed"
fi

# Run lint-staged for linting and formatting
npx lint-staged
